<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Reading google spreadsheet data via API</title>
<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.6/dojo/dojo.xd.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.6/dojo/io/script.js"></script>

<script>
dojo.ready(function()
{

// Fetching data from Google Spreadsheet (code by Frog)
function fetchData()
{
    var jsonpArgs =
    {
        url: 'http://spreadsheets.google.com/feeds/cells/1RI3Ls_ah0hofJK2aOhdFDxwesVVvfwIwDgmP7uY5Iss/od6/public/values?alt=json-in-script',
        callbackParamName: "callback",
        timeout: 5000,
        handleAs: 'json',
        load: function(response)
        {
            var html = '';
            console.log('fetchData response:', response);
            
            html += 'Получено данных в ячейках: ' + response.feed.openSearch$totalResults.$t + '<p>';
            html += 'Последнее обновление таблицы: ' + response.feed.updated.$t + '<p>';

            dojo.forEach(response.feed.entry, function(cell)
            {
                html +=    'Строка:' + cell.gs$cell.row + ' Столбец:' + cell.gs$cell.col + ' Содержимое: ' + cell.gs$cell.$t + '<br>';
            });//forEach
              
            dojo.byId('content').innerHTML = html;

        },//load

        error: function(error)
        {
            console.log('fetchData: An unexpected error occurred: ' + error);
        }//error

    };//jsonpArgs

    dojo.io.script.get(jsonpArgs);

}//fetchData()

fetchData();

});
</script>
</head>
<body>
<div id="content"></div>
</body>
</html>
